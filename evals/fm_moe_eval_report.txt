================================================================================
FLOW MATCHING MIXTURE OF EXPERTS (FM-MoE) EVALUATION REPORT
================================================================================
Generated: 2026-02-04T09:53:25.298110

--------------------------------------------------------------------------------
MODEL CONFIGURATION
--------------------------------------------------------------------------------
  input_dim.......................... 256
  hidden_dim......................... 512
  num_experts........................ 8
  num_selected....................... 2
  flow_steps......................... 10
  time_embed_dim..................... 64
  dropout............................ 0.0
  use_router_aux_loss................ True

--------------------------------------------------------------------------------
MODEL ARCHITECTURE METRICS
--------------------------------------------------------------------------------
  Total Parameters:................. 4,485,120
  Trainable Parameters:............. 4,485,120
  Router Parameters:................ 2,048
  Expert Parameters (total):........ 4,483,072
  Parameters per Expert:............ 560,384
  Model Size (MB):.................. 17.11
  FLOPs per Token (estimate):....... 11,144,448

--------------------------------------------------------------------------------
PERFORMANCE METRICS
--------------------------------------------------------------------------------
  Forward Pass Time (ms):........... 24.324
  Backward Pass Time (ms):.......... 74.868
  Throughput (tokens/sec):.......... 5,262
  Throughput (samples/sec):......... 164.4
  Peak Memory (MB):................. 0.00
  Allocated Memory (MB):............ 0.00

--------------------------------------------------------------------------------
ROUTING & EXPERT UTILIZATION METRICS
--------------------------------------------------------------------------------
  Balance Score:.................... 0.9453
  Routing Entropy:.................. 2.0794
  Load Imbalance Ratio:............. 1.3704
  Expert Utilization Std:........... 0.0146
  Router Confidence (mean):......... 0.1580
  Router Confidence (std):.......... 0.0144
  Sparsity Ratio:................... 0.0000

  Expert Probabilities:
    Expert 0: 0.1269
    Expert 1: 0.1235
    Expert 2: 0.1239
    Expert 3: 0.1255
    Expert 4: 0.1243
    Expert 5: 0.1245
    Expert 6: 0.1245
    Expert 7: 0.1271

  Expert Selection Counts:
    Expert 0: 34
    Expert 1: 31
    Expert 2: 28
    Expert 3: 35
    Expert 4: 27
    Expert 5: 36
    Expert 6: 28
    Expert 7: 37

--------------------------------------------------------------------------------
FLOW MATCHING QUALITY METRICS
--------------------------------------------------------------------------------
  Flow Magnitude (mean):............ 0.0000
  Flow Magnitude (std):............. 0.0000
  Transformation Norm (mean):....... 0.0000
  Transformation Norm (std):........ 0.0000
  Lipschitz Estimate:............... 0.0000
  Reconstruction Error:............. 0.0000
  Information Preservation:......... 1.0000

  Step Convergence (normalized):
    Step 0: 0.0000
    Step 1: 0.0000
    Step 2: 0.0000
    Step 3: 0.0000
    Step 4: 0.0000
    Step 5: 0.0000
    Step 6: 0.0000
    Step 7: 0.0000
    Step 8: 0.0000
    Step 9: 0.0000

--------------------------------------------------------------------------------
SCALABILITY METRICS
--------------------------------------------------------------------------------
  Batch Size:...................... 4
  Sequence Length:................. 32
  Time per Expert (ms):............ 0.663
  Time per Flow Step (ms):......... 0.060
  Memory Scaling Factor:........... 1.00

--------------------------------------------------------------------------------
ABLATION STUDY RESULTS
--------------------------------------------------------------------------------

  Varying num_experts:
       Value     Time(ms)      Throughput       Params   Size(MB)
  -----------------------------------------------------------------
           2       10.156          12,604    1,121,280       4.28
           4       12.669          10,103    2,242,560       8.55
           8       20.752           6,168    4,485,120      17.11
          16       31.725           4,035    8,970,240      34.22

  Varying num_selected:
       Value     Time(ms)      Throughput       Params   Size(MB)
  -----------------------------------------------------------------
           1       18.648           6,864    4,485,120      17.11
           2       19.150           6,684    4,485,120      17.11
           4       29.965           4,272    4,485,120      17.11

  Varying flow_steps:
       Value     Time(ms)      Throughput       Params   Size(MB)
  -----------------------------------------------------------------
           5       10.952          11,688    4,485,120      17.11
          10       19.387           6,602    4,485,120      17.11
          20       36.699           3,488    4,485,120      17.11
          50       99.918           1,281    4,485,120      17.11

================================================================================
END OF EVALUATION REPORT
================================================================================